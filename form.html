<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FESH Form - 7 Steps</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }
    .step-header { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; }
    .step-button { background-color: #4caf50; color: white; padding: 10px 20px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; }
    .step-form { display: none; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.1); max-width: 600px; margin-bottom: 30px; }
    .step-form.active { display: block; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input, select, button { width: 100%; padding: 8px; margin-top: 4px; border-radius: 6px; border: 1px solid #ccc; }
    .button-row button { width: auto; margin-right: 10px; }
    .mic-button { background: none; border: none; font-size: 18px; margin-left: 6px; cursor: pointer; }
    .error-message { color: red; font-size: 13px; margin-top: 4px; }
  </style>
</head>
<body>

<h2>Field Evaluation of Soil Health</h2>

<div class="step-header">
  <button class="step-button" onclick="toggleStep(1)">Step 1: General Info</button>
  <button class="step-button" onclick="toggleStep(2)">Step 2: Crop Info</button>
  <button class="step-button" onclick="toggleStep(3)">Step 3: Topography</button>
  <button class="step-button" onclick="toggleStep(4)">Step 4: Physical Soil</button>
  <button class="step-button" onclick="toggleStep(5)">Step 5: Chemical Soil</button>
  <button class="step-button" onclick="toggleStep(6)">Step 6: Biological Soil</button>
  <button class="step-button" onclick="toggleStep(7)">Step 7: Crop Performance</button>
</div>

<div id="step1" class="step-form active">
  <h3>Step 1: General Information</h3>
  <label for="farmId">Farm ID:</label>
  <input type="text" id="farmId" readonly>

  <label for="farmerName">Farmer Name:
    <button type="button" class="mic-button" onclick="startDictation('farmerName')">üé§</button>
  </label>
  <input type="text" id="farmerName" required>

  <label for="date">Date:</label>
  <input type="date" id="date" required>

  <label for="contact">Phone Number (10 digits):
    <button type="button" class="mic-button" onclick="startDictation('contact')">üé§</button>
  </label>
  <input type="tel" id="contact" required>

  <label>Farm Location (GPS):</label>
  <div class="button-row">
    <button onclick="getLocation()">üìç Get Current Location</button>
    <button onclick="viewMap()">üåê View on Map</button>
  </div>

  <label for="latitude">Latitude:</label>
  <input type="text" id="latitude" readonly>

  <label for="longitude">Longitude:</label>
  <input type="text" id="longitude" readonly>

  <button onclick="validateStep1()">‚úì Confirm and Continue</button>
</div>

<div id="step2" class="step-form">
  <h3>Step 2: Crop Info</h3>
  <label for="cropCategory">Crop Category:</label>
  <select id="cropCategory" onchange="updateCropOptions()">
    <option value="">-- Select Category --</option>
    <option value="cereal">Cereal Crops</option>
    <option value="legume">Legumes</option>
    <option value="root">Root & Tuber Crops</option>
    <option value="forage">Forage & Pasture</option>
    <option value="vegetable">Vegetables</option>
    <option value="fruit">Fruits & Berries</option>
    <option value="other">Other</option>
  </select>

  <div id="cropOptionsContainer" style="margin-top:15px;"></div>

  <label for="area">Land Area (hectares):
    <button type="button" class="mic-button" onclick="startDictation('area')">üé§</button>
  </label>
  <input type="number" id="area" step="0.001" min="0.001" required>

  <button onclick="validateStep2()">‚úì Confirm and Continue</button>
</div>

<div id="step3" class="step-form"><h3>Step 3: Topography</h3></div>
<div id="step4" class="step-form"><h3>Step 4: Physical Soil</h3></div>
<div id="step5" class="step-form"><h3>Step 5: Chemical Soil</h3></div>
<div id="step6" class="step-form"><h3>Step 6: Biological Soil</h3></div>
<div id="step7" class="step-form"><h3>Step 7: Crop Performance</h3></div>

<script>
  function toggleStep(stepNum) {
    document.querySelectorAll('.step-form').forEach((el, i) => {
      el.classList.toggle('active', i === stepNum - 1);
    });
  }

  window.addEventListener('DOMContentLoaded', () => {
    const now = new Date();
    const datePart = now.toISOString().slice(0,10).replace(/-/g, '');
    const rand = Math.floor(1000 + Math.random() * 9000);
    document.getElementById('farmId').value = `FARM-${datePart}-${rand}`;
  });

  function startDictation(fieldId) {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (!SpeechRecognition) return alert("Voice input not supported.");
    const recognition = new SpeechRecognition();
    recognition.lang = "en-US";
    recognition.start();
    recognition.onresult = e => {
      document.getElementById(fieldId).value = e.results[0][0].transcript;
    };
    recognition.onerror = e => alert("Voice error: " + e.error);
  }

  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(pos => {
        document.getElementById("latitude").value = pos.coords.latitude.toFixed(6);
        document.getElementById("longitude").value = pos.coords.longitude.toFixed(6);
      }, err => alert("Location error: " + err.message));
    } else alert("Geolocation not supported");
  }

  function viewMap() {
    const lat = document.getElementById("latitude").value;
    const lon = document.getElementById("longitude").value;
    if (lat && lon) window.open(`https://www.google.com/maps?q=${lat},${lon}`, '_blank');
    else alert("Please get GPS coordinates first.");
  }

  function validateStep1() {
    const fields = ["farmerName", "date", "contact", "latitude", "longitude"];
    let valid = true;
    fields.forEach(id => {
      const el = document.getElementById(id);
      el.style.borderColor = "#ccc";
      if (!el.value || (id === "contact" && !/^[0-9]{10}$/.test(el.value))) {
        el.style.borderColor = "red";
        valid = false;
      }
    });
    if (valid) toggleStep(2);
  }

  function updateCropOptions() {
    const cat = document.getElementById("cropCategory").value;
    const c = document.getElementById("cropOptionsContainer");
    let opts = "";
    if (cat === "cereal") opts = `<label>Crop Type:<select><option>Wheat</option><option>Barley</option><option>Oats</option><option>Corn</option></select></label>`;
    else if (cat === "legume") opts = `<label>Crop Type:<select><option>Soybeans</option><option>Peas</option><option>Beans</option></select></label>`;
    else if (cat === "root") opts = `<label>Crop Type:<select><option>Potatoes</option><option>Carrots</option><option>Beets</option></select></label>`;
    else if (cat === "forage") opts = `<label>Crop Type:<select><option>Alfalfa</option><option>Timothy</option><option>Clover</option></select></label>`;
    else if (cat === "vegetable") opts = `<label>Crop Type:<select><option>Cabbage</option><option>Broccoli</option><option>Spinach</option></select></label>`;
    else if (cat === "fruit") opts = `<label>Crop Type:<select><option>Strawberries</option><option>Blueberries</option><option>Apples</option></select></label>`;
    else if (cat === "other") opts = `<label>Other Crop:<input type='text'></label>`;
    c.innerHTML = opts;
  }

  function validateStep2() {
    const area = parseFloat(document.getElementById("area").value);
    const el = document.getElementById("area");
    el.style.borderColor = "#ccc";
    if (isNaN(area) || area <= 0) {
      alert("Please enter a valid land area (> 0).");
      el.style.borderColor = "red";
      return;
    }
    toggleStep(3);
  }
</script>

</body>
</html>
<!-- Step 3: Topography -->
<div id="step3" class="step-form">
  <h3>Step 3: Topography</h3>

  <label for="slopeClass">Slope Class (%):</label>
  <select id="slopeClass" required>
    <option value="">-- Select --</option>
    <option>0‚Äì1%</option>
    <option>1‚Äì2%</option>
    <option>2‚Äì4%</option>
    <option>4‚Äì8%</option>
    <option>8‚Äì10%</option>
    <option>10‚Äì20%</option>
    <option>20‚Äì50%</option>
    <option>50‚Äì100%</option>
    <option>100‚Äì829%</option>
  </select>

  <label for="slopeDirection">Slope Direction:</label>
  <select id="slopeDirection" required>
    <option value="">-- Select --</option>
    <option>North</option>
    <option>North-East</option>
    <option>East</option>
    <option>South-East</option>
    <option>South</option>
    <option>South-West</option>
    <option>West</option>
    <option>North-West</option>
  </select>

  <label for="landscapePosition">Landscape Position:</label>
  <select id="landscapePosition" required>
    <option value="">-- Select --</option>
    <option>Summit</option>
    <option>Shoulder</option>
    <option>Backslope</option>
    <option>Footslope</option>
    <option>Toeslope</option>
  </select>

  <label for="surfaceForm">Surface Form:</label>
  <select id="surfaceForm" required>
    <option value="">-- Select --</option>
    <option>Flat</option>
    <option>Concave</option>
    <option>Convex</option>
    <option>Complex</option>
  </select>

  <button onclick="validateStep3()">‚úì Confirm and Continue</button>
</div>

<script>
function validateStep3() {
  const fields = ["slopeClass", "slopeDirection", "landscapePosition", "surfaceForm"];
  let valid = true;

  fields.forEach(id => {
    const el = document.getElementById(id);
    el.style.borderColor = "#ccc";
    if (!el.value.trim()) {
      el.style.borderColor = "red";
      valid = false;
    }
  });

  if (valid) {
    alert("‚úÖ Step 3 complete. Moving to Step 4.");
    toggleStep(4);
  } else {
    alert("‚ùó Please complete all highlighted fields in Step 3.");
  }
}
</script>

