<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FESH Soil Health Assessment Form (Voice Enabled)</title>
  <style>
    .step {
      display: none;
      border: 1px solid #ccc;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 10px;
      background-color: #f9f9f9;
    }
    .step.active {
      display: block;
    }
    button {
      padding: 8px 16px;
      margin-top: 10px;
      border-radius: 6px;
    }
    .mic-button {
      margin-right: 10px;
    }
    .hidden {
      display: none;
    }
    .step-header {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 20px 0;
      flex-wrap: wrap;
    }
    .step-box {
      display: inline-block;
      padding: 10px 15px;
      margin: 0 10px;
      background-color: #e0e0e0;
      border-radius: 10px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .step-box.active {
      background-color: #4caf50;
      color: white;
    }
    .step-arrow {
      font-size: 20px;
      color: #333;
      margin: 0 5px;
      user-select: none;
    }
  </style>
</head>
<body>
  <h2>FESH Soil Health Assessment Form (Voice Enabled)</h2>

  <div class="step-header">
    <div class="step-box active" id="header-step1" onclick="goToStep(1)">Step 1: General Info</div>
    <div class="step-arrow">‚Üí</div>
    <div class="step-box" id="header-step2" onclick="goToStep(2)">Step 2: Crop Info</div>
    <div class="step-arrow">‚Üí</div>
    <div class="step-box" id="header-step3" onclick="goToStep(3)">Step 3: Topography</div>
    <div class="step-arrow">‚Üí</div>
    <div class="step-box" id="header-step4" onclick="goToStep(4)">Step 4: Physical Soil</div>
    <div class="step-arrow">‚Üí</div>
    <div class="step-box" id="header-step5" onclick="goToStep(5)">Step 5: Chemical Soil</div>
    <div class="step-arrow">‚Üí</div>
    <div class="step-box" id="header-step6" onclick="goToStep(6)">Step 6: Biological Soil</div>
  </div>

  <form id="feshForm">

    <!-- Step 1 -->
    <div class="step active" id="step1">
      <h3>Step 1: General Information</h3>
      <label for="farmId">Farm ID:</label>
      <input type="text" id="farmId" name="farmId" required><br><br>

      <label>Farmer Name:</label>
      <button type="button" class="mic-button" onclick="startDictation('farmerName')">üé§</button>
      <input type="text" id="farmerName" name="farmerName" required><br><br>

      <label>Date:</label>
      <input type="date" id="date" name="date" required><br><br>

      <label>Phone Number:</label>
      <button type="button" class="mic-button" onclick="startDictation('contact')">üé§</button>
      <input type="tel" id="contact" name="contact" required><br><br>

      <h4>Farm Location (GPS):</h4>
      <button type="button" onclick="getLocation()">üìç Get Current Location</button><br><br>

      <label>Latitude:</label>
      <input type="text" id="latitude" name="latitude" readonly required><br><br>

      <label>Longitude:</label>
      <input type="text" id="longitude" name="longitude" readonly required><br><br>

      <label>Elevation (m):</label>
      <input type="text" id="elevation" name="elevation" readonly><br><br>

      <button type="button" onclick="validateStep(1)">‚úî Confirm and Continue</button>
    </div>

    <!-- Step 2 -->
    <div class="step" id="step2">
      <h3>Step 2: Crop Information</h3>
      <label for="crop">Crop Type:</label>
      <select id="crop" name="crop" required onchange="toggleOtherCrop()">
        <option value="">-- Select Crop --</option>
        <option value="Wheat">Wheat</option>
        <option value="Barley">Barley</option>
        <option value="Corn">Corn</option>
        <option value="Soybeans">Soybeans</option>
        <option value="Oats">Oats</option>
        <option value="Canola">Canola</option>
        <option value="Potatoes">Potatoes</option>
        <option value="Blueberries">Blueberries</option>
        <option value="Carrots">Carrots</option>
        <option value="Cabbage">Cabbage</option>
        <option value="Strawberries">Strawberries</option>
        <option value="Turnip">Turnip</option>
        <option value="Apples">Apples</option>
        <option value="Raspberries">Raspberries</option>
        <option value="Pumpkins">Pumpkins</option>
        <option value="Maple (syrup trees)">Maple (syrup trees)</option>
        <option value="Green Beans">Green Beans</option>
        <option value="Peas">Peas</option>
        <option value="Beets">Beets</option>
        <option value="Other">Other</option>
      </select><br><br>

      <div id="otherCropContainer" class="hidden">
        <label>Specify Other Crop:</label>
        <button type="button" class="mic-button" onclick="startDictation('otherCrop')">üé§</button>
        <input type="text" id="otherCrop" name="otherCrop"><br><br>
      </div>

      <label>Land Area (hectares):</label>
      <button type="button" class="mic-button" onclick="startDictation('area')">üé§</button>
      <input type="number" id="area" name="area" required><br><br>

      <button type="button" onclick="validateStep(2)">‚úî Confirm and Continue</button>
    </div>

    <!-- Step 3 -->
    <div class="step" id="step3">
      <h3>Step 3: Topography Information</h3>

      <label for="slopeValue">Slope:</label>
      <button type="button" class="mic-button" onclick="startDictation('slopeValue')">üé§</button>
      <input type="number" id="slopeValue" name="slopeValue" required />
      <select id="slopeUnit">
        <option value="deg">Degrees (¬∞)</option>
        <option value="percent">Percent (%)</option>
      </select><br /><br />

      <label>Converted:</label>
      <input type="text" id="slopeConverted" readonly /><br /><br />

      <label for="slopeDirection">Slope Direction:</label>
      <select id="slopeDirection" required>
        <option value="">-- Select --</option>
        <option value="North">North</option>
        <option value="South">South</option>
        <option value="East">East</option>
        <option value="West">West</option>
        <option value="Flat">Flat</option>
      </select><br /><br />

      <label for="landscapePosition">Landscape Position:</label>
      <select id="landscapePosition" required>
        <option value="">-- Select --</option>
        <option value="Hilltop">Hilltop</option>
        <option value="Valley">Valley</option>
        <option value="Flatland">Flatland</option>
      </select><br /><br />

      <label for="surfaceForm">Surface Form:</label>
      <select id="surfaceForm" required>
        <option value="">-- Select --</option>
        <option value="Flat">Flat</option>
        <option value="Concave">Concave</option>
        <option value="Convex">Convex</option>
      </select><br /><br />

      <button type="button" onclick="validateStep(3)">‚úî Confirm and Continue</button>
    </div>

    <!-- Step 4 -->
    <div class="step" id="step4">
      <h3>Step 4: Physical Soil Properties</h3>

      <label for="tillageDepth">Tillage Layer Depth (cm):</label>
      <button type="button" class="mic-button" onclick="startDictation('tillageDepth')">üé§</button>
      <input type="number" id="tillageDepth" name="tillageDepth" required /><br /><br />

      <label for="strength">Soil Strength:</label>
      <button type="button" class="mic-button" onclick="startDictation('strength')">üé§</button>
      <input type="number" id="strength" required />
      <select id="strengthUnit">
        <option value="kg/cm¬≤">kg/cm¬≤</option>
        <option value="psi">psi</option>
      </select><br /><br />

      <label for="vess">VESS Score:</label>
      <select id="vess" required>
        <option value="">-- Select --</option>
        <option value="Sq1">Sq1 ‚Äì Excellent</option>
        <option value="Sq2">Sq2 ‚Äì Good</option>
        <option value="Sq3">Sq3 ‚Äì Moderate</option>
        <option value="Sq4">Sq4 ‚Äì Poor</option>
        <option value="Sq5">Sq5 ‚Äì Very Poor</option>
      </select>
      <button type="button" onclick="showVessModal()">‚ùì</button><br /><br />

      <label for="infiltration">Water Infiltration Time (min:sec):</label>
      <button type="button" class="mic-button" onclick="startDictation('infiltration')">üé§</button>
      <input type="text" id="infiltration" placeholder="e.g., 2:30" required /><br /><br />

      <button type="button" onclick="validateStep(4)">‚úî Confirm and Continue</button>
    </div>

    <!-- Step 5 -->
    <div class="step" id="step5">
      <h3>Step 5: Chemical Soil Properties</h3>

      <label for="ph">Soil pH:</label>
      <button type="button" class="mic-button" onclick="startDictation('ph')">üé§</button>
      <input type="number" id="ph" name="ph" min="3.5" max="9.5" step="0.1" required /><br /><br />

      <label for="soilColor">Soil Color:</label>
      <button type="button" class="mic-button" onclick="startDictation('soilColor')">üé§</button>
      <select id="soilColor" name="soilColor" required>
        <option value="">-- Select Color --</option>
        <option>Very Dark Gray</option>
        <option>Dark Gray</option>
        <option>Gray</option>
        <option>Light Gray</option>
        <option>Very Pale Brown</option>
        <option>Pale Brown</option>
        <option>Brown</option>
        <option>Dark Brown</option>
        <option>Yellowish Brown</option>
        <option>Strong Brown</option>
        <option>Reddish Brown</option>
        <option>Dark Reddish Brown</option>
        <option>Light Yellowish Brown</option>
        <option>Dark Yellowish Brown</option>
        <option>Yellow</option>
        <option>Strong Yellow</option>
        <option>Grayish Yellow</option>
        <option>Light Olive</option>
        <option>Olive</option>
        <option>Dark Olive</option>
        <option>Greenish Brown</option>
        <option>Light Reddish Brown</option>
        <option>Orange Brown</option>
        <option>Dark Grayish Brown</option>
      </select>
      <br /><br />

      <img src="images/color soil.jpg" alt="Soil Color Guide" style="max-width: 100%; height: auto;" /><br /><br />

      <button type="button" onclick="validateStep(5)">‚úî Confirm and Continue</button>
    </div>

    <!-- Step 6 -->
    <div class="step" id="step6">
      <h3>Step 6: Biological Soil Properties</h3>

      <label for="emergenceRate">Plant Emergence Rate (%):</label>
      <button type="button" class="mic-button" onclick="startDictation('emergenceRate')">üé§</button>
      <input type="number" id="emergenceRate" name="emergenceRate" min="0" max="100" step="0.1" required /><br /><br />

      <label for="rootDevelopment">Root Development:</label>
      <select id="rootDevelopment" name="rootDevelopment" required>
        <option value="">-- Select --</option>
        <option>None</option>
        <option>Weak</option>
        <option>Moderate</option>
        <option>Strong</option>
      </select><br /><br />

      <label for="rootCoating">Root Coating:</label>
      <select id="rootCoating" name="rootCoating" required>
        <option value="">-- Select --</option>
        <option>None</option>
        <option>Light</option>
        <option>Moderate</option>
        <option>Heavy</option>
      </select><br /><br />

      <label for="earthwormActivity">Earthworm Activity:</label>
      <select id="earthwormActivity" name="earthwormActivity" required>
        <option value="">-- Select --</option>
        <option>No activity</option>
        <option>Low</option>
        <option>Moderate</option>
        <option>High</option>
      </select><br /><br />

      <label for="myceliumDevelopment">Mycelium Development:</label>
      <select id="myceliumDevelopment" name="myceliumDevelopment" required>
        <option value="">-- Select --</option>
        <option>None</option>
        <option>Light</option>
        <option>Moderate</option>
        <option>Heavy</option>
      </select><br /><br />

      <button type="submit">üöÄ Submit Final Form</button>
    </div>

  </form>

<script>
  function startDictation(fieldId) {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (!SpeechRecognition) {
      alert("Your browser does not support voice input.");
      return;
    }
    const recognition = new SpeechRecognition();
    recognition.lang = 'en-US';
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;
    recognition.start();
    recognition.onresult = function(event) {
      const result = event.results[0][0].transcript;
      document.getElementById(fieldId).value = result;
    };
    recognition.onerror = function(event) {
      alert("Voice input error: " + event.error);
    };
  }

  function toggleOtherCrop() {
    const crop = document.getElementById('crop').value;
    const container = document.getElementById('otherCropContainer');
    if (crop === 'Other') {
      container.classList.remove('hidden');
      document.getElementById('otherCrop').required = true;
    } else {
      container.classList.add('hidden');
      document.getElementById('otherCrop').required = false;
    }
  }

  function getLocation() {
    if (!navigator.geolocation) {
      alert("Geolocation is not supported by your browser.");
      return;
    }
    navigator.geolocation.getCurrentPosition(position => {
      document.getElementById('latitude').value = position.coords.latitude.toFixed(6);
      document.getElementById('longitude').value = position.coords.longitude.toFixed(6);
      document.getElementById('elevation').value = position.coords.altitude ? position.coords.altitude.toFixed(2) : "N/A";
    }, () => {
      alert("Unable to retrieve your location.");
    });
  }

  function validateStep(step) {
    const stepDiv = document.getElementById(`step${step}`);
    const inputs = stepDiv.querySelectorAll("input, select");
    let valid = true;
    inputs.forEach(input => {
      if (!input.checkValidity()) {
        valid = false;
        input.reportValidity();
      }
    });
    if (valid) {
      setActiveStep(step + 1);
    }
  }

  function setActiveStep(step) {
    for (let i = 1; i <= 6; i++) {
      const div = document.getElementById(`step${i}`);
      const header = document.getElementById(`header-step${i}`);
      if (i === step) {
        div.classList.add('active');
        header.classList.add('active');
      } else {
        div.classList.remove('active');
        header.classList.remove('active');
      }
    }
  }

  function goToStep(step) {
    // ŸÅŸÇÿ∑ ÿßÿ¨ÿßÿ≤Ÿá ÿ±ŸÅÿ™ŸÜ ÿ®Ÿá ŸÖÿ±ÿ≠ŸÑŸá‚Äåÿß€å ⁄©Ÿá ŸÇÿ®ŸÑÿßŸã ÿ™⁄©ŸÖ€åŸÑ ÿ¥ÿØŸá ÿ®ÿØ€åŸÖ
    // (ŸÖ€å‚Äåÿ™ŸàŸÜ€å ÿß€åŸÜ ÿ¥ÿ±ÿ∑ ÿ±Ÿà ÿ®ÿπÿØÿß ŸÅÿπÿßŸÑ ⁄©ŸÜ€å)
    setActiveStep(step);
  }

  function showVessModal() {
    alert("VESS scores:\n\nSq1 ‚Äì Excellent\nSq2 ‚Äì Good\nSq3 ‚Äì Moderate\nSq4 ‚Äì Poor\nSq5 ‚Äì Very Poor");
  }
</script>

</body>
</html>
