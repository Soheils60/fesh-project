<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>فرم چندمرحله‌ای FESH</title>
<style>
  body {
    font-family: Arial, sans-serif;
    direction: rtl;
    background: #f0f2f5;
    margin: 20px;
  }
  .stepper {
    display: flex;
    justify-content: space-between;
    margin-bottom: 25px;
  }
  .step {
    flex: 1;
    text-align: center;
    padding: 10px 0;
    margin: 0 5px;
    background-color: #a5d6a7;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    color: #2e7d32;
    transition: background-color 0.3s ease;
  }
  .step.active {
    background-color: #388e3c;
    color: #fff;
  }
  .step.disabled {
    background-color: #c8e6c9;
    color: #999;
    cursor: default;
  }
  .step-form {
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px #ccc;
    display: none;
  }
  .step-form.active {
    display: block;
  }
  label {
    display: block;
    margin-top: 15px;
    font-weight: bold;
  }
  input[type="text"],
  input[type="number"],
  input[type="date"],
  select {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    box-sizing: border-box;
    border-radius: 4px;
    border: 1px solid #ccc;
    font-size: 15px;
  }
  input.error,
  select.error {
    border-color: red;
  }
  .error-message {
    color: red;
    font-size: 13px;
    margin-top: 4px;
  }
  button {
    margin-top: 25px;
    padding: 12px 25px;
    font-size: 16px;
    background-color: #388e3c;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  button:disabled {
    background-color: #a5d6a7;
    cursor: default;
  }
</style>
</head>
<body>

<div class="stepper" id="stepper">
  <div class="step active" data-step="1">مرحله 1</div>
  <div class="step disabled" data-step="2">مرحله 2</div>
  <div class="step disabled" data-step="3">مرحله 3</div>
  <div class="step disabled" data-step="4">مرحله 4</div>
  <div class="step disabled" data-step="5">مرحله 5</div>
  <div class="step disabled" data-step="6">مرحله 6</div>
</div>

<!-- مرحله 1 -->
<div id="step1" class="step-form active">
  <h2>مرحله 1: اطلاعات عمومی</h2>
  <label for="farmId">Farm ID</label>
  <input type="text" id="farmId" readonly />
  <label for="date">تاریخ</label>
  <input type="date" id="date" />
  <div class="error-message" id="error-date"></div>

  <label for="farmerName">نام کشاورز</label>
  <input type="text" id="farmerName" />
  <div class="error-message" id="error-farmerName"></div>

  <label for="mobileNumber">شماره موبایل (۱۰ رقم)</label>
  <input type="text" id="mobileNumber" maxlength="10" />
  <div class="error-message" id="error-mobileNumber"></div>

  <label for="location">مختصات (GPS)</label>
  <input type="text" id="location" readonly />
  <button type="button" onclick="getLocation()">دریافت موقعیت</button>
  <div class="error-message" id="error-location"></div>

  <button onclick="validateStep(1)">تأیید و ادامه</button>
</div>

<!-- مرحله 2 -->
<div id="step2" class="step-form">
  <h2>مرحله 2: اطلاعات محصول و عملکرد</h2>

  <label for="cropType">نوع محصول</label>
  <select id="cropType">
    <option value="">-- انتخاب کنید --</option>
    <optgroup label="غلات">
      <option value="wheat">گندم</option>
      <option value="barley">جو</option>
      <option value="oats">یولاف</option>
      <option value="grain_corn">ذرت دانه‌ای</option>
    </optgroup>
    <optgroup label="سبزیجات">
      <option value="potato">سیب‌زمینی</option>
      <option value="cabbage">کلم</option>
      <option value="carrot">هویج</option>
      <option value="onion">پیاز</option>
      <option value="lettuce">کاهو</option>
      <option value="beet">چغندر</option>
      <option value="green_peas">نخود سبز</option>
    </optgroup>
    <optgroup label="حبوبات">
      <option value="beans">لوبیا</option>
      <option value="dry_peas">نخود خشک</option>
      <option value="lentils">عدس</option>
    </optgroup>
    <optgroup label="علوفه‌ای">
      <option value="alfalfa">یونجه</option>
      <option value="red_clover">شبدر قرمز</option>
      <option value="timothy">تیموتی</option>
      <option value="mixed_forage">مخلوط علوفه‌ای</option>
    </optgroup>
    <optgroup label="سایر محصولات زراعی">
      <option value="silage_corn">ذرت سیلویی</option>
      <option value="soybeans">سویا</option>
      <option value="canola">کلزا</option>
      <option value="flax">کتان</option>
    </optgroup>
    <optgroup label="محصولات باغی">
      <option value="apple">سیب</option>
      <option value="blueberry">بلوبری</option>
      <option value="strawberry">توت‌فرنگی</option>
      <option value="raspberry">تمشک</option>
    </optgroup>
    <option value="other">سایر</option>
  </select>
  <div class="error-message" id="error-cropType"></div>

  <label for="fieldArea">مساحت زمین (هکتار)</label>
  <input type="number" step="0.01" id="fieldArea" placeholder="مثلاً 3.25" />
  <div class="error-message" id="error-fieldArea"></div>

  <label for="estimatedYield">عملکرد محصول (تن در هکتار)</label>
  <input type="number" step="0.01" id="estimatedYield" placeholder="مثلاً 12.40" />
  <div class="error-message" id="error-estimatedYield"></div>

  <button onclick="validateStep(2)">تأیید و ادامه</button>
</div>

<!-- مرحله 3 -->
<div id="step3" class="step-form">
  <h2>مرحله 3: توپوگرافی</h2>

  <label for="slopeClass">طبقه شیب (%)</label>
  <select id="slopeClass">
    <option value="">-- انتخاب کنید --</option>
    <option value="0-1">0–1%</option>
    <option value="1-2">1–2%</option>
    <option value="2-4">2–4%</option>
    <option value="4-8">4–8%</option>
    <option value="8-10">8–10%</option>
    <option value="10-20">10–20%</option>
    <option value="20-50">20–50%</option>
    <option value="50-100">50–100%</option>
    <option value="100+">بیشتر از 100%</option>
  </select>
  <div class="error-message" id="error-slopeClass"></div>

  <label for="slopeDirection">جهت شیب</label>
  <select id="slopeDirection">
    <option value="">-- انتخاب کنید --</option>
    <option value="North">North</option>
    <option value="North-East">North-East</option>
    <option value="East">East</option>
    <option value="South-East">South-East</option>
    <option value="South">South</option>
    <option value="South-West">South-West</option>
    <option value="West">West</option>
    <option value="North-West">North-West</option>
  </select>
  <div class="error-message" id="error-slopeDirection"></div>

  <label for="landscapePosition">موقعیت در چشم‌انداز</label>
  <select id="landscapePosition">
    <option value="">-- انتخاب کنید --</option>
    <option value="Summit">Summit</option>
    <option value="Shoulder">Shoulder</option>
    <option value="Backslope">Backslope</option>
    <option value="Footslope">Footslope</option>
    <option value="Toeslope">Toeslope</option>
  </select>
  <div class="error-message" id="error-landscapePosition"></div>

  <label for="surfaceForm">فرم سطح</label>
  <select id="surfaceForm">
    <option value="">-- انتخاب کنید --</option>
    <option value="Flat">Flat</option>
    <option value="Convex">Convex</option>
    <option value="Concave">Concave</option>
  </select>
  <div class="error-message" id="error-surfaceForm"></div>

  <button onclick="validateStep(3)">تأیید و ادامه</button>
</div>

<!-- مرحله 4 -->
<div id="step4" class="step-form">
  <h2>مرحله 4: ویژگی‌های فیزیکی خاک</h2>

  <label for="infiltrationMinute">زمان نفوذ - دقیقه</label>
  <select id="infiltrationMinute">
    <option value="">-- انتخاب کنید --</option>
    <!-- 0 تا 59 -->
    <option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option>
  </select>
  <div class="error-message" id="error-infiltrationMinute"></div>

  <label for="infiltrationSecond">زمان نفوذ - ثانیه</label>
  <select id="infiltrationSecond">
    <option value="">-- انتخاب کنید --</option>
    <!-- 0 تا 59 -->
    <option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option>
  </select>
  <div class="error-message" id="error-infiltrationSecond"></div>

  <label for="soilStructure">ساختار خاک (VESS Score)</label>
  <select id="soilStructure">
    <option value="">-- انتخاب کنید --</option>
    <option value="1">Sq1 – Very Good</option>
    <option value="2">Sq2 – Good</option>
    <option value="3">Sq3 – Moderate</option>
    <option value="4">Sq4 – Poor</option>
    <option value="5">Sq5 – Very Poor</option>
  </select>
  <div class="error-message" id="error-soilStructure"></div>

  <label for="tillageLayer">عمق لایه خاک‌ورزی (سانتی‌متر)</label>
  <input type="number" step="0.01" id="tillageLayer" placeholder="مثلاً 25.50" />
  <div class="error-message" id="error-tillageLayer"></div>

  <label for="soilStrength">مقاومت خاک (kg/cm²)</label>
  <input type="number" step="0.01" id="soilStrength" placeholder="مثلاً 1.75" />
  <div class="error-message" id="error-soilStrength"></div>

  <button onclick="validateStep(4)">تأیید و ادامه</button>
</div>

<!-- مرحله 5 -->
<div id="step5" class="step-form">
  <h2>مرحله 5: ویژگی‌های شیمیایی خاک</h2>

  <label for="soilPh">pH خاک (0 تا 14)</label>
  <input type="number" id="soilPh" step="0.01" min="0" max="14" placeholder="مثلاً 6.50" />
  <div class="error-message" id="error-soilPh"></div>

  <label for="soilColor">رنگ خاک</label>
  <select id="soilColor">
    <option value="">-- انتخاب کنید --</option>
    <option value="Very black">Very black</option>
    <option value="Black">Black</option>
    <option value="Very dark brown">Very dark brown</option>
    <option value="Dark brown">Dark brown</option>
    <option value="Medium dark brown">Medium dark brown</option>
    <option value="Brown">Brown</option>
    <option value="Medium brown">Medium brown</option>
    <option value="Light brown">Light brown</option>
    <option value="Very light brown">Very light brown</option>
    <option value="Yellowish brown">Yellowish brown</option>
    <option value="Yellow brown">Yellow brown</option>
    <option value="Pale brown">Pale brown</option>
    <option value="Reddish brown">Reddish brown</option>
    <option value="Dark reddish brown">Dark reddish brown</option>
    <option value="Very dark gray">Very dark gray</option>
    <option value="Dark gray">Dark gray</option>
    <option value="Gray">Gray</option>
    <option value="Light gray">Light gray</option>
    <option value="Very light gray">Very light gray</option>
    <option value="Yellowish gray">Yellowish gray</option>
    <option value="Olive">Olive</option>
    <option value="Dark olive">Dark olive</option>
    <option value="Red">Red</option>
    <option value="Orange brown">Orange brown</option>
  </select>
  <div class="error-message" id="error-soilColor"></div>

  <button onclick="validateStep(5)">تأیید و ادامه</button>
</div>

<!-- مرحله 6 -->
<div id="step6" class="step-form">
  <h2>مرحله 6: ویژگی‌های بیولوژیکی خاک</h2>

  <label for="earthwormCount">تعداد کرم خاکی (0 تا 100)</label>
  <select id="earthwormCount">
    <option value="">-- انتخاب کنید --</option>
    <!-- 0 تا 100 -->
    <option value="0">0</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
    <option value="13">13</option>
    <option value="14">14</option>
    <option value="15">15</option>
    <option value="16">16</option>
    <option value="17">17</option>
    <option value="18">18</option>
    <option value="19">19</option>
    <option value="20">20</option>
    <option value="21">21</option>
    <option value="22">22</option>
    <option value="23">23</option>
    <option value="24">24</option>
    <option value="25">25</option>
    <option value="26">26</option>
    <option value="27">27</option>
    <option value="28">28</option>
    <option value="29">29</option>
    <option value="30">30</option>
    <option value="31">31</option>
    <option value="32">32</option>
    <option value="33">33</option>
    <option value="34">34</option>
    <option value="35">35</option>
    <option value="36">36</option>
    <option value="37">37</option>
    <option value="38">38</option>
    <option value="39">39</option>
    <option value="40">40</option>
    <option value="41">41</option>
    <option value="42">42</option>
    <option value="43">43</option>
    <option value="44">44</option>
    <option value="45">45</option>
    <option value="46">46</option>
    <option value="47">47</option>
    <option value="48">48</option>
    <option value="49">49</option>
    <option value="50">50</option>
    <option value="51">51</option>
    <option value="52">52</option>
    <option value="53">53</option>
    <option value="54">54</option>
    <option value="55">55</option>
    <option value="56">56</option>
    <option value="57">57</option>
    <option value="58">58</option>
    <option value="59">59</option>
    <option value="60">60</option>
    <option value="61">61</option>
    <option value="62">62</option>
    <option value="63">63</option>
    <option value="64">64</option>
    <option value="65">65</option>
    <option value="66">66</option>
    <option value="67">67</option>
    <option value="68">68</option>
    <option value="69">69</option>
    <option value="70">70</option>
    <option value="71">71</option>
    <option value="72">72</option>
    <option value="73">73</option>
    <option value="74">74</option>
    <option value="75">75</option>
    <option value="76">76</option>
    <option value="77">77</option>
    <option value="78">78</option>
    <option value="79">79</option>
    <option value="80">80</option>
    <option value="81">81</option>
    <option value="82">82</option>
    <option value="83">83</option>
    <option value="84">84</option>
    <option value="85">85</option>
    <option value="86">86</option>
    <option value="87">87</option>
    <option value="88">88</option>
    <option value="89">89</option>
    <option value="90">90</option>
    <option value="91">91</option>
    <option value="92">92</option>
    <option value="93">93</option>
    <option value="94">94</option>
    <option value="95">95</option>
    <option value="96">96</option>
    <option value="97">97</option>
    <option value="98">98</option>
    <option value="99">99</option>
    <option value="100">100</option>
  </select>
  <div class="error-message" id="error-earthwormCount"></div>

  <label for="microbialActivity">فعالیت میکروبی</label>
  <select id="microbialActivity">
    <option value="">-- انتخاب کنید --</option>
    <option value="Low">کم</option>
    <option value="Medium">متوسط</option>
    <option value="High">زیاد</option>
  </select>
  <div class="error-message" id="error-microbialActivity"></div>

  <label for="soilOrganicMatter">ماده آلی خاک</label>
  <select id="soilOrganicMatter">
    <option value="">-- انتخاب کنید --</option>
    <option value="Low">کم</option>
    <option value="Medium">متوسط</option>
    <option value="High">زیاد</option>
  </select>
  <div class="error-message" id="error-soilOrganicMatter"></div>

  <label for="rootDensity">تراکم ریشه</label>
  <select id="rootDensity">
    <option value="">-- انتخاب کنید --</option>
    <option value="Low">کم</option>
    <option value="Medium">متوسط</option>
    <option value="High">زیاد</option>
  </select>
  <div class="error-message" id="error-rootDensity"></div>

  <button onclick="validateStep(6)">تأیید و ادامه</button>
</div>

<script>
  let currentStep = 1;
  const totalSteps = 6;

  function showStep(step) {
    for (let i = 1; i <= totalSteps; i++) {
      const form = document.getElementById(`step${i}`);
      const stepBtn = document.querySelector(`.step[data-step="${i}"]`);
      if (i === step) {
        form.classList.add("active");
        stepBtn.classList.add("active");
        stepBtn.classList.remove("disabled");
      } else {
        form.classList.remove("active");
        stepBtn.classList.remove("active");
        if (i > currentStep) stepBtn.classList.add("disabled");
      }
    }
  }

  function validateStep(step) {
    if (step === 1) {
      let valid = true;

      document.getElementById("error-date").textContent = "";
      document.getElementById("error-farmerName").textContent = "";
      document.getElementById("error-mobileNumber").textContent = "";
      document.getElementById("error-location").textContent = "";

      const date = document.getElementById("date");
      const farmerName = document.getElementById("farmerName");
      const mobileNumber = document.getElementById("mobileNumber");
      const location = document.getElementById("location");

      if (!date.value) {
        valid = false;
        date.classList.add("error");
        document.getElementById("error-date").textContent = "تاریخ را وارد کنید";
      } else {
        date.classList.remove("error");
      }

      if (!farmerName.value.trim()) {
        valid = false;
        farmerName.classList.add("error");
        document.getElementById("error-farmerName").textContent = "نام کشاورز را وارد کنید";
      } else {
        farmerName.classList.remove("error");
      }

      if (!/^\d{10}$/.test(mobileNumber.value)) {
        valid = false;
        mobileNumber.classList.add("error");
        document.getElementById("error-mobileNumber").textContent = "شماره موبایل باید 10 رقم باشد";
      } else {
        mobileNumber.classList.remove("error");
      }

      if (!location.value) {
        valid = false;
        location.classList.add("error");
        document.getElementById("error-location").textContent = "موقعیت GPS را دریافت کنید";
      } else {
        location.classList.remove("error");
      }

      if (valid) {
        currentStep++;
        showStep(currentStep);
      }
    } else if (step === 2) {
      let valid = true;

      document.getElementById("error-cropType").textContent = "";
      document.getElementById("error-fieldArea").textContent = "";
      document.getElementById("error-estimatedYield").textContent = "";

      const cropType = document.getElementById("cropType");
      const fieldArea = document.getElementById("fieldArea");
      const estimatedYield = document.getElementById("estimatedYield");

      if (!cropType.value) {
        valid = false;
        cropType.classList.add("error");
        document.getElementById("error-cropType").textContent = "نوع محصول را انتخاب کنید";
      } else {
        cropType.classList.remove("error");
      }

      if (!fieldArea.value || parseFloat(fieldArea.value) <= 0) {
        valid = false;
        fieldArea.classList.add("error");
        document.getElementById("error-fieldArea").textContent = "مساحت معتبر وارد کنید";
      } else {
        fieldArea.classList.remove("error");
      }

      if (!estimatedYield.value || parseFloat(estimatedYield.value) <= 0) {
        valid = false;
        estimatedYield.classList.add("error");
        document.getElementById("error-estimatedYield").textContent = "عملکرد معتبر وارد کنید";
      } else {
        estimatedYield.classList.remove("error");
      }

      if (valid) {
        currentStep++;
        showStep(currentStep);
      }
    } else if (step === 3) {
      let valid = true;

      document.getElementById("error-slopeClass").textContent = "";
      document.getElementById("error-slopeDirection").textContent = "";
      document.getElementById("error-landscapePosition").textContent = "";
      document.getElementById("error-surfaceForm").textContent = "";

      const slopeClass = document.getElementById("slopeClass");
      const slopeDirection = document.getElementById("slopeDirection");
      const landscapePosition = document.getElementById("landscapePosition");
      const surfaceForm = document.getElementById("surfaceForm");

      if (!slopeClass.value) {
        valid = false;
        slopeClass.classList.add("error");
        document.getElementById("error-slopeClass").textContent = "طبقه شیب را انتخاب کنید";
      } else {
        slopeClass.classList.remove("error");
      }

      if (!slopeDirection.value) {
        valid = false;
        slopeDirection.classList.add("error");
        document.getElementById("error-slopeDirection").textContent = "جهت شیب را انتخاب کنید";
      } else {
        slopeDirection.classList.remove("error");
      }

      if (!landscapePosition.value) {
        valid = false;
        landscapePosition.classList.add("error");
        document.getElementById("error-landscapePosition").textContent = "موقعیت چشم‌انداز را انتخاب کنید";
      } else {
        landscapePosition.classList.remove("error");
      }

      if (!surfaceForm.value) {
        valid = false;
        surfaceForm.classList.add("error");
        document.getElementById("error-surfaceForm").textContent = "فرم سطح را انتخاب کنید";
      } else {
        surfaceForm.classList.remove("error");
      }

      if (valid) {
        currentStep++;
        showStep(currentStep);
      }
    } else if (step === 4) {
      let valid = true;

      document.getElementById("error-infiltrationMinute").textContent = "";
      document.getElementById("error-infiltrationSecond").textContent = "";
      document.getElementById("error-soilStructure").textContent = "";
      document.getElementById("error-tillageLayer").textContent = "";
      document.getElementById("error-soilStrength").textContent = "";

      const infiltrationMinute = document.getElementById("infiltrationMinute");
      const infiltrationSecond = document.getElementById("infiltrationSecond");
      const soilStructure = document.getElementById("soilStructure");
      const tillageLayer = document.getElementById("tillageLayer");
      const soilStrength = document.getElementById("soilStrength");

      if (!infiltrationMinute.value) {
        valid = false;
        infiltrationMinute.classList.add("error");
        document.getElementById("error-infiltrationMinute").textContent = "دقیقه را انتخاب کنید";
      } else {
        infiltrationMinute.classList.remove("error");
      }

      if (!infiltrationSecond.value) {
        valid = false;
        infiltrationSecond.classList.add("error");
        document.getElementById("error-infiltrationSecond").textContent = "ثانیه را انتخاب کنید";
      } else {
        infiltrationSecond.classList.remove("error");
      }

      if (!soilStructure.value) {
        valid = false;
        soilStructure.classList.add("error");
        document.getElementById("error-soilStructure").textContent = "امتیاز ساختار خاک را انتخاب کنید";
      } else {
        soilStructure.classList.remove("error");
      }

      if (!tillageLayer.value || parseFloat(tillageLayer.value) <= 0) {
        valid = false;
        tillageLayer.classList.add("error");
        document.getElementById("error-tillageLayer").textContent = "عمق لایه خاک‌ورزی معتبر وارد کنید";
      } else {
        tillageLayer.classList.remove("error");
      }

      if (!soilStrength.value || parseFloat(soilStrength.value) <= 0) {
        valid = false;
        soilStrength.classList.add("error");
        document.getElementById("error-soilStrength").textContent = "مقاومت خاک معتبر وارد کنید";
      } else {
        soilStrength.classList.remove("error");
      }

      if (valid) {
        currentStep++;
        showStep(currentStep);
      }
    } else if (step === 5) {
      let valid = true;

      document.getElementById("error-soilPh").textContent = "";
      document.getElementById("error-soilColor").textContent = "";

      const soilPh = document.getElementById("soilPh");
      const soilColor = document.getElementById("soilColor");

      if (!soilPh.value || soilPh.value < 0 || soilPh.value > 14) {
        valid = false;
        soilPh.classList.add("error");
        document.getElementById("error-soilPh").textContent = "مقدار pH باید بین 0 تا 14 باشد";
      } else {
        soilPh.classList.remove("error");
      }

      if (!soilColor.value) {
        valid = false;
        soilColor.classList.add("error");
        document.getElementById("error-soilColor").textContent = "رنگ خاک را انتخاب کنید";
      } else {
        soilColor.classList.remove("error");
      }

      if (valid) {
        currentStep++;
        showStep(currentStep);
      }
    } else if (step === 6) {
      let valid = true;

      document.getElementById("error-earthwormCount").textContent = "";
      document.getElementById("error-microbialActivity").textContent = "";
      document.getElementById("error-soilOrganicMatter").textContent = "";
      document.getElementById("error-rootDensity").textContent = "";

      const earthwormCount = document.getElementById("earthwormCount");
      const microbialActivity = document.getElementById("microbialActivity");
      const soilOrganicMatter = document.getElementById("soilOrganicMatter");
      const rootDensity = document.getElementById("rootDensity");

      if (!earthwormCount.value) {
        valid = false;
        earthwormCount.classList.add("error");
        document.getElementById("error-earthwormCount").textContent = "تعداد کرم خاکی را انتخاب کنید";
      } else {
        earthwormCount.classList.remove("error");
      }

      if (!microbialActivity.value) {
        valid = false;
        microbialActivity.classList.add("error");
        document.getElementById("error-microbialActivity").textContent = "فعالیت میکروبی را انتخاب کنید";
      } else {
        microbialActivity.classList.remove("error");
      }

      if (!soilOrganicMatter.value) {
        valid = false;
        soilOrganicMatter.classList.add("error");
        document.getElementById("error-soilOrganicMatter").textContent = "ماده آلی خاک را انتخاب کنید";
      } else {
        soilOrganicMatter.classList.remove("error");
      }

      if (!rootDensity.value) {
        valid = false;
        rootDensity.classList.add("error");
        document.getElementById("error-rootDensity").textContent = "تراکم ریشه را انتخاب کنید";
      } else {
        rootDensity.classList.remove("error");
      }

      if (valid) {
        currentStep++;
        showStep(currentStep);
      }
    }
  }

  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        (position) => {
          const locInput = document.getElementById("location");
          locInput.value = `${position.coords.latitude.toFixed(6)}, ${position.coords.longitude.toFixed(6)}`;
        },
        () => {
          alert("موقعیت‌یابی فعال نیست یا اجازه داده نشده است.");
        }
      );
    } else {
      alert("مرورگر شما قابلیت موقعیت‌یابی ندارد.");
    }
  }

  function generateFarmId() {
    const now = new Date();
    const day = String(now.getDate()).padStart(2, "0");
    const month = String(now.getMonth() + 1).padStart(2, "0");
    const year = now.getFullYear();
    const randomNum = Math.floor(100 + Math.random() * 900);
    const farmId = `${day}-${month}-${year}-${randomNum}`;
    document.getElementById("farmId").value = farmId;
  }

  window.onload = () => {
    generateFarmId();
    showStep(currentStep);
  };
</script>

</body>
</html>
